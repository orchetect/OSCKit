{"metadata":{"modules":[{"name":"OSCKit"}],"role":"collectionGroup","roleHeading":"API Collection","title":"OSC Address Pattern Parsing"},"abstract":[{"type":"text","text":"Methods for parsing OSC Message address patterns."}],"topicSections":[{"identifiers":["doc:\/\/osckit.OSCKit\/documentation\/OSCKit\/OSCAddressPattern","doc:\/\/osckit.OSCKit\/documentation\/OSCKit\/OSCAddressSpace"],"anchor":"Topics"}],"primaryContentSections":[{"kind":"content","content":[{"level":2,"text":"Overview","type":"heading","anchor":"Overview"},{"inlineContent":[{"type":"text","text":"There are a few approaches to parsing OSC message address patterns, depending on your needs."}],"type":"paragraph"},{"text":"Background","anchor":"Background","level":2,"type":"heading"},{"type":"paragraph","inlineContent":[{"type":"text","text":"An OSC Method is defined as being the last path component in the address. OSC Methods are the"},{"type":"text","text":" "},{"text":"potential destinations of OSC messages received by the OSC server and correspond to each of the","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"points of control that the application makes available."}]},{"inlineContent":[{"type":"text","text":"The "},{"code":"methodname","type":"codeVoice"},{"type":"text","text":" path component is the method name in the following address examples:"}],"type":"paragraph"},{"type":"codeListing","code":["\/methodname","\/container1\/container2\/methodname"],"syntax":null},{"type":"paragraph","inlineContent":[{"text":"Any other path components besides the last are referred to as ","type":"text"},{"type":"emphasis","inlineContent":[{"type":"text","text":"containers"}]},{"type":"text","text":"."}]},{"inlineContent":[{"type":"text","text":"A container may also be a method. Simply register it the same way as other methods."}],"type":"paragraph"},{"type":"heading","level":3,"text":"Imperative address pattern matching","anchor":"Imperative-address-pattern-matching"},{"inlineContent":[{"text":"Simple matching can be performed using the ","type":"text"},{"identifier":"doc:\/\/osckit.OSCKit\/documentation\/OSCKit\/OSCAddressPattern\/matches(localAddress:)","isActive":true,"type":"reference"},{"text":" method directly on the message’s ","type":"text"},{"isActive":true,"type":"reference","identifier":"doc:\/\/osckit.OSCKit\/documentation\/OSCKit\/OSCMessage\/addressPattern"},{"text":" property.","type":"text"}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["\/\/ example: received OSC message with address \"\/{some,other}\/address\/*\"","private func handle(received message: OSCMessage) throws {","    let pattern = message.addressPattern","    if pattern.matches(localAddress: \"\/some\/address\/methodA\") { ","        \/\/ (will match in this example)","        \/\/ ... perform methodA action using message.values ...","    }","    if pattern.matches(localAddress: \"\/some\/address\/methodB\") {","        \/\/ (will match in this example)","        \/\/ ... perform methodB action using message.values ...","    }","    if pattern.matches(localAddress: \"\/different\/methodC\") {","        \/\/ (won't match in this example)","        \/\/ ... perform methodC action using message.values ...","    }","}"]},{"anchor":"Using-OSCAddressSpace-for-automated-address-pattern-matching","type":"heading","text":"Using OSCAddressSpace for automated address pattern matching","level":3},{"inlineContent":[{"text":"OSCKit provides an abstraction called ","type":"text"},{"identifier":"doc:\/\/osckit.OSCKit\/documentation\/OSCKit\/OSCAddressSpace","type":"reference","isActive":true},{"type":"text","text":". This object is generally instanced once and stored globally."}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"text":"Each local OSC address (OSC Method) is registered once with this object in order to enable it to perform matching against received OSC message address patterns. Each method is assigned an ID, and can optionally store a closure.","type":"text"}]},{"inlineContent":[{"text":"Method IDs, method closures, or a combination of both may be used for maximum flexibility.","type":"text"}],"type":"paragraph"},{"anchor":"OSCAddressSpace-with-Method-IDs","type":"heading","level":4,"text":"OSCAddressSpace with Method IDs"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Registration will return a unique ID token to correspond to each method that is registered. This can be stored and used to identify methods that ","type":"text"},{"type":"reference","identifier":"doc:\/\/osckit.OSCKit\/documentation\/OSCKit\/OSCAddressSpace","isActive":true},{"type":"text","text":" matches for you."}]}]},{"content":[{"inlineContent":[{"text":"When an OSC message is received:","type":"text"}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"text":"Pass its address pattern to ","type":"text"},{"isActive":true,"identifier":"doc:\/\/osckit.OSCKit\/documentation\/OSCKit\/OSCAddressSpace\/methods(matching:)","type":"reference"},{"type":"text","text":"."}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"This method will pattern-match it against all registered local addresses and return an array of local method IDs that match."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"You can then compare the IDs to ones you stored while registering the local methods."}]}]}],"type":"unorderedList"}]}]},{"code":["\/\/ instance address space and register methods only once, usually at app startup.","let addressSpace = OSCAddressSpace()","let idMethodA = addressSpace.register(localAddress: \"\/methodA\")","let idMethodB = addressSpace.register(localAddress: \"\/some\/address\/methodB\")"],"syntax":"swift","type":"codeListing"},{"type":"codeListing","code":["func handle(message: OSCMessage) throws {","    let ids = addressSpace.methods(matching: message.addressPattern)","    ","    try ids.forEach { id in","        switch id {","        case idMethodA:","            let str = try message.values.masked(String.self)","            performMethodA(str)","        case idMethodB:","            let (str, int) = try message.values.masked(String.self, Int?.self)","            performMethodB(str, int)","        default:","            print(\"Received unhandled OSC message:\", message)","        }","    }","}","","func performMethodA(_ str: String) { }","func performMethodB(_ str: String, _ int: Int?) { }"],"syntax":"swift"},{"text":"OSCAddressSpace with Method Closure Blocks","anchor":"OSCAddressSpace-with-Method-Closure-Blocks","type":"heading","level":4},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"When registering a local method, it can also store a closure. This closure can be executed automatically when matching against a received OSC message’s address pattern."}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"When an OSC message is received:"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Pass its address pattern to the "},{"identifier":"doc:\/\/osckit.OSCKit\/documentation\/OSCKit\/OSCAddressSpace\/dispatch(_:)","type":"reference","isActive":true},{"type":"text","text":"."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"This method will pattern-match it against all registered local addresses and execute their closures, optionally on a specified queue."}]}]},{"content":[{"inlineContent":[{"text":"It also returns an array of local method IDs that match exactly like ","type":"text"},{"identifier":"doc:\/\/osckit.OSCKit\/documentation\/OSCKit\/OSCAddressSpace\/methods(matching:)","isActive":true,"type":"reference"},{"type":"text","text":" (which may be discarded if handling of unregistered\/unrecognized methods is not needed)."}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"If the returned method ID array is empty, that indicates that no methods matched the address pattern. In this case you may want to handle the unhandled message in a special way."}],"type":"paragraph"}]}]}]}]},{"syntax":"swift","code":["\/\/ instance address space and register methods only once, usually at app startup.","let addressSpace = OSCAddressSpace()","addressSpace.register(localAddress: \"\/methodA\") { values in","    guard let str = try? message.values.masked(String.self) else { return }","    performMethodA(str)","}","addressSpace.register(localAddress: \"\/some\/address\/methodB\") { values in","    guard let (str, int) = try message.values.masked(String.self, Int?.self) else { return }","    performMethodB(str, int)","}"],"type":"codeListing"},{"syntax":"swift","code":["func handle(message: OSCMessage) async throws {","    let ids = await addressSpace.dispatch(message)","    if ids.isEmpty {","        print(\"Received unhandled OSC message:\", message)","    }","}","","func performMethodA(_ str: String) { }","func performMethodB(_ str: String, _ int: Int?) { }"],"type":"codeListing"}]}],"hierarchy":{"paths":[["doc:\/\/osckit.OSCKit\/documentation\/OSCKit"],["doc:\/\/osckit.OSCKit\/documentation\/OSCKit","doc:\/\/osckit.OSCKit\/documentation\/OSCKit\/Receiving-OSC"]]},"seeAlsoSections":[{"anchor":"OSC-Messages","title":"OSC Messages","generated":true,"identifiers":["doc:\/\/osckit.OSCKit\/documentation\/OSCKit\/OSCMessage","doc:\/\/osckit.OSCKit\/documentation\/OSCKit\/OSC-Value-Types","doc:\/\/osckit.OSCKit\/documentation\/OSCKit\/OSC-Value-Parsing"]}],"variants":[{"paths":["\/documentation\/osckit\/osc-address-pattern-parsing"],"traits":[{"interfaceLanguage":"swift"}]}],"kind":"article","sections":[],"identifier":{"url":"doc:\/\/osckit.OSCKit\/documentation\/OSCKit\/OSC-Address-Pattern-Parsing","interfaceLanguage":"swift"},"schemaVersion":{"patch":0,"minor":3,"major":0},"references":{"doc://osckit.OSCKit/documentation/OSCKit/OSCMessage/addressPattern":{"url":"\/documentation\/osckit\/oscmessage\/addresspattern","abstract":[{"text":"OSC message address pattern.","type":"text"}],"title":"addressPattern","fragments":[{"kind":"keyword","text":"let"},{"kind":"text","text":" "},{"kind":"identifier","text":"addressPattern"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"OSCAddressPattern","preciseIdentifier":"s:10OSCKitCore17OSCAddressPatternV"}],"identifier":"doc:\/\/osckit.OSCKit\/documentation\/OSCKit\/OSCMessage\/addressPattern","type":"topic","role":"symbol","kind":"symbol"},"doc://osckit.OSCKit/documentation/OSCKit/OSCAddressSpace/methods(matching:)":{"kind":"symbol","abstract":[{"text":"Returns all OSC address nodes matching the address pattern.","type":"text"}],"role":"symbol","fragments":[{"text":"func","kind":"keyword"},{"kind":"text","text":" "},{"text":"methods","kind":"identifier"},{"text":"(","kind":"text"},{"text":"matching","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"OSCAddressPattern","preciseIdentifier":"s:10OSCKitCore17OSCAddressPatternV","kind":"typeIdentifier"},{"text":") -> [","kind":"text"},{"text":"OSCAddressSpace","preciseIdentifier":"s:10OSCKitCore15OSCAddressSpaceC","kind":"typeIdentifier"},{"text":".","kind":"text"},{"preciseIdentifier":"s:10OSCKitCore15OSCAddressSpaceC8MethodIDV","text":"MethodID","kind":"typeIdentifier"},{"kind":"text","text":"]"}],"title":"methods(matching:)","identifier":"doc:\/\/osckit.OSCKit\/documentation\/OSCKit\/OSCAddressSpace\/methods(matching:)","type":"topic","url":"\/documentation\/osckit\/oscaddressspace\/methods(matching:)"},"doc://osckit.OSCKit/documentation/OSCKit/OSCAddressPattern/matches(localAddress:)":{"kind":"symbol","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"matches"},{"kind":"text","text":"("},{"kind":"externalParam","text":"localAddress"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"String","preciseIdentifier":"s:SS"},{"kind":"text","text":") -> "},{"preciseIdentifier":"s:Sb","text":"Bool","kind":"typeIdentifier"}],"role":"symbol","title":"matches(localAddress:)","url":"\/documentation\/osckit\/oscaddresspattern\/matches(localaddress:)","abstract":[{"text":"Returns ","type":"text"},{"type":"codeVoice","code":"true"},{"type":"text","text":" if the address matches a given local address."},{"type":"text","text":" "},{"type":"text","text":"Employs address pattern matching if the inbound address contains a pattern."}],"type":"topic","identifier":"doc:\/\/osckit.OSCKit\/documentation\/OSCKit\/OSCAddressPattern\/matches(localAddress:)"},"doc://osckit.OSCKit/documentation/OSCKit/OSC-Value-Parsing":{"role":"collectionGroup","identifier":"doc:\/\/osckit.OSCKit\/documentation\/OSCKit\/OSC-Value-Parsing","kind":"article","abstract":[{"type":"text","text":"Methods for parsing OSC Message value collections."}],"title":"OSC Value Parsing","url":"\/documentation\/osckit\/osc-value-parsing","type":"topic"},"doc://osckit.OSCKit/documentation/OSCKit/OSC-Value-Types":{"title":"OSC Value Types","role":"collectionGroup","abstract":[{"text":"OSC Message value types.","type":"text"}],"type":"topic","identifier":"doc:\/\/osckit.OSCKit\/documentation\/OSCKit\/OSC-Value-Types","url":"\/documentation\/osckit\/osc-value-types","kind":"article"},"doc://osckit.OSCKit/documentation/OSCKit/Receiving-OSC":{"kind":"article","abstract":[{"type":"text","text":"Receiving OSC messages and bundles."}],"role":"collectionGroup","title":"Receiving OSC","identifier":"doc:\/\/osckit.OSCKit\/documentation\/OSCKit\/Receiving-OSC","type":"topic","url":"\/documentation\/osckit\/receiving-osc"},"doc://osckit.OSCKit/documentation/OSCKit/OSCAddressSpace/dispatch(_:)":{"url":"\/documentation\/osckit\/oscaddressspace\/dispatch(_:)","title":"dispatch(_:)","abstract":[{"type":"text","text":"Executes the closure blocks (and passes the OSC message values to them) for all local OSC"},{"type":"text","text":" "},{"type":"text","text":"address nodes matching the address pattern in the OSC message."},{"text":" ","type":"text"},{"type":"text","text":"If a "},{"type":"codeVoice","code":"queue"},{"text":" is supplied, blocks will be dispatched on the ","type":"text"},{"code":"queue","type":"codeVoice"},{"type":"text","text":" with its default QoS."},{"type":"text","text":" "},{"type":"text","text":"If no "},{"code":"queue","type":"codeVoice"},{"type":"text","text":" is supplied, the closures are dispatched synchronously on the current queue."}],"identifier":"doc:\/\/osckit.OSCKit\/documentation\/OSCKit\/OSCAddressSpace\/dispatch(_:)","role":"symbol","kind":"symbol","type":"topic","fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"text":"dispatch","kind":"identifier"},{"text":"(","kind":"text"},{"text":"OSCMessage","preciseIdentifier":"s:10OSCKitCore10OSCMessageV","kind":"typeIdentifier"},{"text":") ","kind":"text"},{"text":"async","kind":"keyword"},{"text":" -> [","kind":"text"},{"text":"OSCAddressSpace","kind":"typeIdentifier","preciseIdentifier":"s:10OSCKitCore15OSCAddressSpaceC"},{"kind":"text","text":"."},{"text":"MethodID","kind":"typeIdentifier","preciseIdentifier":"s:10OSCKitCore15OSCAddressSpaceC8MethodIDV"},{"kind":"text","text":"]"}]},"doc://osckit.OSCKit/documentation/OSCKit":{"role":"collection","url":"\/documentation\/osckit","kind":"symbol","abstract":[{"text":"Open Sound Control (OSC) library for macOS, iOS and tvOS.","type":"text"}],"title":"OSCKit","identifier":"doc:\/\/osckit.OSCKit\/documentation\/OSCKit","type":"topic"},"doc://osckit.OSCKit/documentation/OSCKit/OSCMessage":{"role":"symbol","fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"OSCMessage","kind":"identifier"}],"kind":"symbol","title":"OSCMessage","navigatorTitle":[{"kind":"identifier","text":"OSCMessage"}],"type":"topic","identifier":"doc:\/\/osckit.OSCKit\/documentation\/OSCKit\/OSCMessage","url":"\/documentation\/osckit\/oscmessage","abstract":[{"text":"OSC Message.","type":"text"}]},"doc://osckit.OSCKit/documentation/OSCKit/OSCAddressSpace":{"url":"\/documentation\/osckit\/oscaddressspace","title":"OSCAddressSpace","abstract":[{"type":"text","text":"OSC address space populated with a local address tree by registering OSC methods, offering"},{"type":"text","text":" "},{"type":"text","text":"methods to match and dispatch against received OSC address patterns."}],"identifier":"doc:\/\/osckit.OSCKit\/documentation\/OSCKit\/OSCAddressSpace","role":"symbol","kind":"symbol","type":"topic","fragments":[{"text":"class","kind":"keyword"},{"text":" ","kind":"text"},{"text":"OSCAddressSpace","kind":"identifier"}],"navigatorTitle":[{"text":"OSCAddressSpace","kind":"identifier"}]},"doc://osckit.OSCKit/documentation/OSCKit/OSCAddressPattern":{"url":"\/documentation\/osckit\/oscaddresspattern","title":"OSCAddressPattern","abstract":[{"type":"text","text":"OSC Address Pattern"}],"identifier":"doc:\/\/osckit.OSCKit\/documentation\/OSCKit\/OSCAddressPattern","role":"symbol","kind":"symbol","type":"topic","fragments":[{"kind":"keyword","text":"struct"},{"text":" ","kind":"text"},{"text":"OSCAddressPattern","kind":"identifier"}],"navigatorTitle":[{"text":"OSCAddressPattern","kind":"identifier"}]}}}